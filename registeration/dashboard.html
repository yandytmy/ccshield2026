<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CCShield2026 å ±åˆ°é€²åº¦çœ‹æ¿</title>
    <style>
        :root { --success: #43A047; --pending: #444; --bg: #1a1a1a; --primary: #1E88E5; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: white; margin: 0; padding: 20px; overflow-x: hidden; }
        
        h1 { font-size: 2.5em; margin-bottom: 10px; color: #fff; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .stats-container { background: #333; padding: 20px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .count-text { font-size: 4em; font-weight: bold; color: var(--primary); margin: 10px 0; }
        
        .progress-container { width: 100%; background: #555; height: 30px; border-radius: 15px; margin: 20px 0; position: relative; overflow: hidden; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, #1E88E5, #43A047); width: 0%; transition: width 1.5s ease-in-out; }

        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); gap: 15px; max-width: 1000px; margin: 0 auto; }
        .team-box { padding: 25px 10px; border-radius: 10px; font-size: 24px; font-weight: bold; transition: 0.5s; border: 2px solid rgba(255,255,255,0.1); }
        .done { background: var(--success); color: white; border-color: #fff; box-shadow: 0 0 15px rgba(67, 160, 71, 0.5); transform: scale(1.05); }
        .pending { background: var(--pending); color: #777; }

        .footer { margin-top: 40px; font-size: 14px; color: #666; }
    </style>
</head>
<body>

    <h1>ğŸ† ç¸½ç›£æŒ‘æˆ°ç›¾ 2026</h1>
    <div class="stats-container">
        <div>å³æ™‚å ±åˆ°é€²åº¦</div>
        <div class="count-text"><span id="count">0</span> / 26</div>
        <div class="progress-container">
            <div id="fill" class="progress-bar"></div>
        </div>
    </div>

    <div id="grid" class="grid"></div>

    <div class="footer">æ•¸æ“šæ¯ 30 ç§’è‡ªå‹•æ›´æ–°ä¸€æ¬¡</div>

    <script>
        // æ›¿æ›æˆä½ ã€Œå ±åˆ°å›æ‡‰è©¦ç®—è¡¨ã€çš„æ–° API ç¶²å€
        const API_URL = "https://script.google.com/macros/s/AKfycbwi4X-ot0tqvH2E07KNQNsVtVtm8yRObSaKCYifaS4JVsueCq4zh23g6pghOZgpljuM/exec"; 

        async function refreshStats() {
            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                const reported = data.reported; // å·²å ±åˆ°çš„éšŠè™Ÿé™£åˆ—

                // 1. æ›´æ–°è¨ˆæ•¸
                document.getElementById('count').innerText = data.totalCount;
                
                // 2. æ›´æ–°é€²åº¦æ¢
                const percent = (data.totalCount / 26) * 100;
                document.getElementById('fill').style.width = percent + "%";

                // 3. æ›´æ–° 1-26 éšŠæ ¼å­
                const grid = document.getElementById('grid');
                grid.innerHTML = "";
                for (let i = 1; i <= 26; i++) {
                    const t = String(i).padStart(2, '0');
                    const isDone = reported.includes(t);
                    const div = document.createElement('div');
                    div.className = `team-box ${isDone ? 'done' : 'pending'}`;
                    div.innerText = t;
                    grid.appendChild(div);
                }
                console.log("Stats updated at " + new Date().toLocaleTimeString());
            } catch (err) {
                console.error("Fetch error:", err);
            }
        }

        // å•Ÿå‹•
        refreshStats();
        // å®šæ™‚æ›´æ–° (30000ms = 30s)
        setInterval(refreshStats, 30000);
    </script>
</body>
</html>